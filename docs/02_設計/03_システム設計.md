# WebSys ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ

## ğŸ¯ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

WebSysã¯ã€ãƒ¢ãƒ€ãƒ³ãª3å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ¡ç”¨ã—ãŸä¼æ¥­å‘ã‘ç¤¾å†…ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚
DockeråŒ–ã«ã‚ˆã‚Šä¸€è²«ã—ãŸé–‹ç™ºãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ä½“é¨“ã‚’æä¾›ã—ã€ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–ã«ã‚ˆã‚‹é«˜æ€§èƒ½ãƒ»é«˜å¯ç”¨æ€§ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚

> ğŸ“Š **è©³ç´°æŠ€è¡“ä»•æ§˜**: [MASTER_REFERENCE.md](01_åŸºæœ¬/02_æŠ€è¡“ä»•æ§˜çµ±ä¸€.md) ã§ä¸€å…ƒç®¡ç†ã•ã‚Œã¦ã„ã¾ã™

## å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WebSys Development Platform              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Frontend   â”‚â”€â”€â”€â”€â”‚   Backend   â”‚â”€â”€â”€â”€â”‚  PostgreSQL â”‚     â”‚
â”‚  â”‚  (Vue.js)   â”‚    â”‚  (Express)  â”‚    â”‚     DB      â”‚     â”‚
â”‚  â”‚  Port: 3000 â”‚    â”‚  Port: 8000 â”‚    â”‚  Port: 5432 â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Docker Network Layer                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     Host Environment                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯æ¦‚è¦

### ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: Vue.js 3.4 + Element Plus 2.8 + TypeScript 5.4
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Express 4.19 + Prisma 5.10 + PostgreSQL 15
- **ã‚¤ãƒ³ãƒ•ãƒ©**: Docker + Docker Compose + Alpine Linux
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: JWT + RBAC + ç›£æŸ»ãƒ­ã‚°

> ğŸ“Š **å®Œå…¨ãªæŠ€è¡“ä»•æ§˜ãƒ»ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: [MASTER_REFERENCE.md - æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯](./MASTER_REFERENCE.md#-æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ç¢ºå®šç‰ˆ) ã‚’å‚ç…§

## ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°

### Frontend (Vue.js + Element Plus)

#### æ§‹æˆ
```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.ts              # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ App.vue              # ãƒ«ãƒ¼ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ components/          # å†åˆ©ç”¨å¯èƒ½ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ views/               # ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ Layout.vue       # ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ Login.vue        # ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢
â”‚   â”‚   â”œâ”€â”€ Dashboard.vue    # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
â”‚   â”‚   â””â”€â”€ Users.vue        # ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
â”‚   â”œâ”€â”€ router/              # ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®š
â”‚   â”œâ”€â”€ stores/              # çŠ¶æ…‹ç®¡ç† (Pinia)
â”‚   â”œâ”€â”€ api/                 # APIé€šä¿¡å±¤
â”‚   â””â”€â”€ assets/              # é™çš„è³‡æº
â”œâ”€â”€ public/                  # å…¬é–‹ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ package.json             # ä¾å­˜é–¢ä¿‚å®šç¾©
â”œâ”€â”€ vite.config.ts           # Viteè¨­å®š
â”œâ”€â”€ tsconfig.json            # TypeScriptè¨­å®š
â””â”€â”€ index.html               # HTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
```

#### ç‰¹å¾´
- **è‡ªå‹•ã‚¤ãƒ³ãƒãƒ¼ãƒˆ**: Element Plus ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è‡ªå‹•ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- **TypeScript**: å®Œå…¨ãªå‹å®‰å…¨æ€§
- **ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰**: é–‹ç™ºæ™‚ã®é«˜é€Ÿãƒªãƒ­ãƒ¼ãƒ‰
- **ãƒ—ãƒ­ã‚­ã‚·è¨­å®š**: APIå‘¼ã³å‡ºã—ã®é€éçš„ãƒ—ãƒ­ã‚­ã‚·
- **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–**: ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œUI

### Backend (Express + Prisma)

#### æ§‹æˆ
```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts             # ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ routes/              # APIãƒ«ãƒ¼ãƒˆå®šç¾©
â”‚   â”‚   â”œâ”€â”€ auth.ts          # èªè¨¼é–¢é€£API
â”‚   â”‚   â””â”€â”€ users.ts         # ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†API
â”‚   â”œâ”€â”€ middleware/          # ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â”‚   â”‚   â”œâ”€â”€ auth.ts          # èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â”‚   â”‚   â””â”€â”€ errorHandler.ts # ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
â”‚   â”œâ”€â”€ controllers/         # ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼å±¤
â”‚   â”œâ”€â”€ services/            # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤
â”‚   â””â”€â”€ utils/               # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma        # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ
â”œâ”€â”€ package.json             # ä¾å­˜é–¢ä¿‚å®šç¾©
â””â”€â”€ tsconfig.json            # TypeScriptè¨­å®š
```

#### ç‰¹å¾´
- **RESTful API**: æ¨™æº–çš„ãªREST APIè¨­è¨ˆ
- **JWTèªè¨¼**: ãƒˆãƒ¼ã‚¯ãƒ³ãƒ™ãƒ¼ã‚¹èªè¨¼
- **å‹å®‰å…¨ORM**: Prismaã«ã‚ˆã‚‹å‹å®‰å…¨ãªDBæ“ä½œ
- **ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**: å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®å³å¯†ãªæ¤œè¨¼
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: çµ±ä¸€ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼å‡¦ç†
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: CORS, Rate Limitingå¯¾å¿œ

### Database (PostgreSQL)

#### æ§‹æˆ
```
PostgreSQL 15
â”œâ”€â”€ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: websys_db_{environment}
â”œâ”€â”€ ãƒ¦ãƒ¼ã‚¶ãƒ¼: admin
â”œâ”€â”€ æ¥ç¶šãƒ—ãƒ¼ãƒ«: Prismaç®¡ç†
â”œâ”€â”€ ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³: Prisma Migrate
â””â”€â”€ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—: Docker Volume
```

#### ã‚¹ã‚­ãƒ¼ãƒ
```sql
-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«
User {
  id: int (PK, Auto Increment)
  username: string (Unique)
  email: string (Unique)
  password: string (bcrypt)
  name: string
  department: string (Optional)
  role: UserRole (ADMIN|USER|GUEST)
  isActive: boolean (Default: true)
  createdAt: DateTime
  updatedAt: DateTime
}
```

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### èªè¨¼ãƒ•ãƒ­ãƒ¼
```
1. Client â†’ POST /api/auth/login (username, password)
2. Backend â†’ bcrypt.compare(password, hashedPassword)
3. Backend â†’ jwt.sign({userId, username, role})
4. Backend â†’ Response {token, user}
5. Client â†’ localStorage.setItem('token', token)
6. Client â†’ All requests include Authorization: Bearer <token>
```

### APIé€šä¿¡ãƒ•ãƒ­ãƒ¼
```
1. Frontend (axios) â†’ API Request with JWT
2. Backend Middleware â†’ JWT Verification
3. Backend Controller â†’ Request Processing
4. Backend Service â†’ Business Logic
5. Prisma ORM â†’ Database Query
6. Database â†’ Query Result
7. Backend â†’ JSON Response
8. Frontend â†’ UI Update
```

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### èªè¨¼ãƒ»èªå¯
- **JWTèªè¨¼**: ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹èªè¨¼
- **Role-based Access**: å½¹å‰²ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- **Token Expiration**: ãƒˆãƒ¼ã‚¯ãƒ³æœ‰åŠ¹æœŸé™ç®¡ç†
- **Password Hashing**: bcrypt (rounds: 12)

### ãƒ‡ãƒ¼ã‚¿ä¿è­·
- **Input Validation**: express-validator
- **SQL Injection Prevention**: Prisma ORM
- **XSS Protection**: Vue.js Template Escaping
- **CORS**: Cross-Origin Resource Sharingè¨­å®š

### é‹ç”¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- **Environment Variables**: æ©Ÿå¯†æƒ…å ±ã®åˆ†é›¢
- **Non-root User**: ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ã®éç‰¹æ¨©å®Ÿè¡Œ
- **Network Isolation**: Docker Bridge Network
- **Health Checks**: ã‚µãƒ¼ãƒ“ã‚¹ç›£è¦–

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æœ€é©åŒ–
- **Code Splitting**: Vite ã«ã‚ˆã‚‹å‹•çš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- **Tree Shaking**: æœªä½¿ç”¨ã‚³ãƒ¼ãƒ‰ã®é™¤å»
- **Hot Module Replacement**: é–‹ç™ºæ™‚ã®é«˜é€Ÿãƒªãƒ­ãƒ¼ãƒ‰
- **Production Build**: æœ€é©åŒ–ã•ã‚ŒãŸãƒ“ãƒ«ãƒ‰

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æœ€é©åŒ–
- **Connection Pooling**: Prisma æ¥ç¶šãƒ—ãƒ¼ãƒ«
- **Query Optimization**: Prisma ã‚¯ã‚¨ãƒªæœ€é©åŒ–
- **Caching Strategy**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¬ãƒ™ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- **Health Checks**: ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½

### ã‚¤ãƒ³ãƒ•ãƒ©æœ€é©åŒ–
- **Docker Layer Caching**: ãƒ“ãƒ«ãƒ‰æ™‚é–“çŸ­ç¸®
- **Volume Management**: ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
- **Network Optimization**: å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€šä¿¡
- **Resource Limits**: ãƒªã‚½ãƒ¼ã‚¹åˆ¶é™è¨­å®š

## ç›£è¦–ãƒ»ãƒ­ã‚°

### ãƒ­ã‚°æˆ¦ç•¥
- **Application Logs**: morgan ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
- **Error Logs**: æ§‹é€ åŒ–ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
- **Access Logs**: HTTP ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°
- **Docker Logs**: ã‚³ãƒ³ãƒ†ãƒŠãƒ­ã‚°é›†ç´„

### ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- **Frontend**: HTTP GET /
- **Backend**: HTTP GET /health
- **Database**: pg_isready ã‚³ãƒãƒ³ãƒ‰
- **Container**: Docker Healthcheck

## æ‹¡å¼µæ€§

### æ°´å¹³ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
- **Frontend**: CDN + Load Balancer
- **Backend**: Multiple Instances + Load Balancer
- **Database**: Read Replicas + Connection Pooling

### å‚ç›´ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
- **Resource Limits**: CPU/Memory åˆ¶é™èª¿æ•´
- **Connection Pool**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæ•°èª¿æ•´
- **Cache Layer**: Redis ç­‰ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¿½åŠ 

### ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–
- **Service Separation**: æ©Ÿèƒ½åˆ¥ã‚µãƒ¼ãƒ“ã‚¹åˆ†é›¢
- **API Gateway**: çµ±ä¸€ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
- **Event-Driven**: éåŒæœŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°
- **Container Orchestration**: Kubernetes ç§»è¡Œ